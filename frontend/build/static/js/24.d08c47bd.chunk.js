(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[24],{629:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var c=a(114);var r=a(165);function s(e){return function(e){if(Array.isArray(e))return Object(c.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(r.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},630:function(e,t,a){"use strict";t.a=a.p+"static/media/add.b7874215.svg"},738:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return x}));var c=a(629),r=a(63),s=a.n(r),n=a(112),l=a(48),o=a(1),i=a.n(o),u=a(630),d=a(631),j=a(113),b=a(83),m=a(626),p=a(20),h=a(11);function x(){var e=Object(p.g)(),t=i.a.useContext(b.b).user,a=i.a.useState(""),r=Object(l.a)(a,2),o=r[0],x=r[1],O=i.a.useState(""),f=Object(l.a)(O,2),v=f[0],g=f[1],y=i.a.useState(""),S=Object(l.a)(y,2),_=S[0],N=S[1],w=i.a.useState(""),C=Object(l.a)(w,2),F=C[0],k=C[1],q=i.a.useState(""),A=Object(l.a)(q,2),T=A[0],D=(A[1],i.a.useState("")),P=Object(l.a)(D,2),I=P[0],B=P[1],U=i.a.useState("None"),V=Object(l.a)(U,2),R=V[0],z=(V[1],i.a.useState(j.a[0])),J=Object(l.a)(z,2),M=J[0],E=J[1],L=i.a.useState(""),Q=Object(l.a)(L,2),G=Q[0],H=Q[1],K=i.a.useState(""),W=Object(l.a)(K,2),X=W[0],Y=W[1],Z=i.a.useState(0),$=Object(l.a)(Z,2),ee=$[0],te=$[1],ae=i.a.useState(0),ce=Object(l.a)(ae,2),re=ce[0],se=ce[1],ne=i.a.useState(0),le=Object(l.a)(ne,2),oe=le[0],ie=le[1],ue=i.a.useState("percent"),de=Object(l.a)(ue,2),je=de[0],be=de[1],me=i.a.useState(0),pe=Object(l.a)(me,2),he=pe[0],xe=pe[1],Oe=i.a.useState(""),fe=Object(l.a)(Oe,2),ve=fe[0],ge=fe[1],ye=i.a.useState(""),Se=Object(l.a)(ye,2),_e=Se[0],Ne=Se[1],we=i.a.useState([]),Ce=Object(l.a)(we,2),Fe=Ce[0],ke=Ce[1],qe=i.a.useState([]),Ae=Object(l.a)(qe,2),Te=Ae[0],De=Ae[1],Pe=i.a.useState([]),Ie=Object(l.a)(Pe,2),Be=Ie[0],Ue=Ie[1],Ve=i.a.useState([]),Re=Object(l.a)(Ve,2),ze=Re[0],Je=Re[1],Me=i.a.useState([]),Ee=Object(l.a)(Me,2),Le=Ee[0],Qe=Ee[1],Ge=0,He=0,Ke=0,We=0,Xe=0,Ye=i.a.useState("percent"),Ze=Object(l.a)(Ye,2),$e=Ze[0],et=Ze[1],tt=i.a.useState(0),at=Object(l.a)(tt,2),ct=at[0],rt=at[1],st=i.a.useState(0),nt=Object(l.a)(st,2),lt=nt[0],ot=nt[1],it=i.a.useState("cash"),ut=Object(l.a)(it,2),dt=ut[0],jt=ut[1],bt=i.a.useState(0),mt=Object(l.a)(bt,2),pt=mt[0],ht=mt[1],xt=i.a.useState(0),Ot=Object(l.a)(xt,2),ft=Ot[0],vt=Ot[1],gt=i.a.useState(0),yt=Object(l.a)(gt,2),St=yt[0],_t=yt[1],Nt=i.a.useState(""),wt=Object(l.a)(Nt,2),Ct=wt[0],Ft=wt[1],kt=0,qt=0,At=0,Tt=0,Dt=0,Pt=0,It=0;i.a.useEffect((function(){function e(){return(e=Object(n.a)(s.a.mark((function e(){var a,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(j.d+"fetchNeedsPurchase",{method:"GET",headers:{Authorization:null===t||void 0===t?void 0:t.token}});case 2:if(!0!==(a=e.sent).ok){e.next=8;break}return e.next=6,a.json();case 6:200===(c=e.sent).status?(console.log(c),ke(null===c||void 0===c?void 0:c.item_list),De(null===c||void 0===c?void 0:c.party_list.map((function(e){return{value:e.id,label:e.name}}))),Ue(null===c||void 0===c?void 0:c.state_list.map((function(e){return{value:e.id,label:e.name}})))):m.b.error(c.message);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);ee>0&&re>0&&M&&(qt=parseFloat(ee)*parseFloat(re),Tt=qt/100*parseFloat(M),kt=At=qt+Tt,"Item"!=R&&"Both"!=R||(Dt=At,"percent"==je&&(It=parseFloat(Dt)/100*parseFloat(he),kt=Pt=Dt-It),"amount"==je&&(It=parseFloat(he),kt=Pt=Dt-It)));pt>0&&("Bill"==R||"Both"==R?("percent"==$e&&(We=pt/100*parseFloat(ct),pt,Xe=pt-We),"amount"==$e&&(We=parseFloat(ct),pt,Xe=pt-We),Ge=Xe,He=Math.round(Xe),Ke=He-parseFloat(lt)):(Ge=pt,He=Math.round(Ge),Ke=He-parseFloat(lt)));return Object(h.jsxs)("div",{className:"container full-size-create-page-main-section",children:[Object(h.jsx)(m.a,{}),Object(h.jsxs)("form",{children:[Object(h.jsxs)("div",{className:"p-sm-5 px-md-3 create-form-field create-purchase-page",children:[Object(h.jsxs)("div",{class:"py-4 px-2 form-row create-purchase-header",children:[Object(h.jsxs)("div",{class:"form-group col-md-3",children:[Object(h.jsxs)("label",{for:"invoice-number",children:["Bill Invoice No.",Object(h.jsx)("span",{className:"required-label",children:"*"})]}),Object(h.jsx)("input",{value:o,onChange:function(e){return x(e.target.value)},type:"text",class:"form-control",id:"invoice-number",required:!0})]}),Object(h.jsxs)("div",{class:"form-group col-md-6 row",children:[Object(h.jsxs)("div",{className:"col-9",children:[Object(h.jsxs)("label",{for:"input-party",children:["Party",Object(h.jsx)("span",{className:"required-label",children:"*"})]}),Object(h.jsx)(d.a,{options:Te,value:F,onChange:function(e){(k(e),e.value&&o)?function(){var a=Object(n.a)(s.a.mark((function a(){var c,r,n;return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return(c=new FormData).append("invoice_number",o),c.append("party_id",e.value),a.next=5,fetch(j.d+"getPurchaseDate",{method:"POST",headers:{Authorization:t.token},body:c});case 5:if(!0!==(r=a.sent).ok){a.next=11;break}return a.next=9,r.json();case 9:200==(n=a.sent).status?g(Object(j.b)(n.data.purchase_date)):m.b.error(n.message);case 11:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}()():m.b.warn("Cannot fetch the date automatically provide valid invoice or select party")}})]}),Object(h.jsx)("div",{className:"col-3 d-flex align-items-end pb-2",children:Object(h.jsx)("img",{className:"img-fluid",src:u.a,alt:""})})]}),Object(h.jsxs)("div",{class:"form-group col-md-3",children:[Object(h.jsxs)("label",{for:"date",children:["Purchase Date",Object(h.jsx)("span",{className:"required-label",children:"*"})]}),Object(h.jsx)("input",{className:"form-control",value:v,onChange:function(e){return g(e.target.value)},type:"date",class:"form-control",id:"date",required:!0})]}),Object(h.jsxs)("div",{class:"form-group col-md-3",children:[Object(h.jsxs)("label",{for:"date",children:["Return Date",Object(h.jsx)("span",{className:"required-label",children:"*"})]}),Object(h.jsx)("input",{className:"form-control",value:_,onChange:function(e){return N(e.target.value)},type:"date",class:"form-control",id:"date",required:!0})]}),Object(h.jsxs)("div",{class:"form-group mt-md-3 col-md-4",children:[Object(h.jsxs)("label",{for:"los",children:["LOS (Location Of Supply)",Object(h.jsx)("span",{className:"required-label",children:"*"})]}),Object(h.jsx)(d.a,{options:Be,value:I,onChange:B})]})]}),Object(h.jsxs)("div",{class:"my-4 form-row",children:[Object(h.jsxs)("div",{class:"form-group col-md-4",children:[Object(h.jsxs)("label",{for:"invoice-number",children:["Item",Object(h.jsx)("span",{className:"required-label",children:"*"})]}),Object(h.jsx)(d.a,{options:Fe,value:G,onChange:function(e){H(e);var t=[];Fe.map((function(a){a.value===e.value&&(a.primary_unit_id&&t.push({value:a.primary_unit_id,label:"Primary Unit (".concat(a.primary_unit,")")}),a.secondary_unit_id&&t.push({value:a.secondary_unit_id,label:"Secondary Unit (".concat(a.secondary_unit_name,")")}))})),Je(t)}})]}),Object(h.jsxs)("div",{class:"form-group col-md-4",children:[Object(h.jsx)("label",{for:"invoice-number",children:"Item Description"}),Object(h.jsx)("textarea",{value:ve,onChange:function(e){return ge(e.target.value)},class:"form-control"})]}),Object(h.jsxs)("div",{class:"form-group col-md-4",children:[Object(h.jsxs)("label",{for:"invoice-number",children:["Unit",Object(h.jsx)("span",{className:"required-label",children:"*"})]}),Object(h.jsx)(d.a,{options:ze,value:X,onChange:Y})]}),Object(h.jsxs)("div",{class:"form-group col-md-4",children:[Object(h.jsxs)("label",{for:"invoice-number",children:["Cost/Unit",Object(h.jsx)("span",{className:"required-label",children:"*"})]}),Object(h.jsx)("input",{value:ee,onChange:function(e){return te(e.target.value)},type:"text",class:"form-control",id:""})]}),Object(h.jsxs)("div",{class:"form-group col-md-4",children:[Object(h.jsxs)("label",{for:"invoice-number",children:["Quantity",Object(h.jsx)("span",{className:"required-label",children:"*"})]}),Object(h.jsx)("input",{value:re,onChange:function(e){return se(e.target.value)},type:"text",class:"form-control",id:""})]}),Object(h.jsxs)("div",{class:"form-group col-md-4",children:[Object(h.jsxs)("label",{for:"invoice-number",children:["Free",Object(h.jsx)("span",{className:"required-label",children:"*"})]}),Object(h.jsx)("input",{value:oe,onChange:function(e){return ie(e.target.value)},type:"text",class:"form-control",id:""})]}),Object(h.jsxs)("div",{class:"form-group col-md-4",children:[Object(h.jsxs)("label",{for:"invoice-number",children:["Tax%",Object(h.jsx)("span",{className:"required-label",children:"*"})]}),Object(h.jsx)("select",{className:"form-control",placeholder:"Select tax value",value:M,onChange:function(e){return E(e.target.value)},children:j.a.map((function(e){return Object(h.jsx)("option",{value:e,children:e})}))})]}),"Item"==R&&Object(h.jsxs)("div",{className:"form-group col-md-4",children:[Object(h.jsx)("label",{htmlFor:"",children:"Discount"}),Object(h.jsxs)("div",{className:"m-0 p-0 col-12 row",children:[Object(h.jsx)("div",{className:"px-0 col-5",children:Object(h.jsx)("input",{value:he,onChange:function(e){return xe(e.target.value)},class:"form-control",type:"text",name:"",id:""})}),Object(h.jsx)("div",{className:"p-0 col-7",children:Object(h.jsxs)("select",{value:je,onChange:function(e){return be(e.target.value)},class:"form-control",required:!0,children:[Object(h.jsx)("option",{value:"",children:"Select Type"}),Object(h.jsx)("option",{value:"percent",children:"Percent"}),Object(h.jsx)("option",{value:"amount",children:"Amount"})]})})]})]}),"Both"==R&&Object(h.jsxs)("div",{className:"form-group col-md-4",children:[Object(h.jsx)("label",{htmlFor:"",children:"Discount"}),Object(h.jsxs)("div",{className:"m-0 p-0 col-12 row",children:[Object(h.jsx)("div",{className:"px-0 col-5",children:Object(h.jsx)("input",{value:he,onChange:function(e){return xe(e.target.value)},class:"form-control",type:"text",name:"",id:""})}),Object(h.jsx)("div",{className:"p-0 col-7",children:Object(h.jsxs)("select",{value:je,onChange:function(e){return be(e.target.value)},class:"form-control",required:!0,children:[Object(h.jsx)("option",{value:"",children:"Select Type"}),Object(h.jsx)("option",{value:"percent",children:"Percent"}),Object(h.jsx)("option",{value:"amount",children:"Amount"})]})})]})]}),Object(h.jsxs)("div",{class:"form-group col-md-4 row",children:[Object(h.jsxs)("div",{class:"form-group col-9",children:[Object(h.jsxs)("label",{for:"invoice-number",children:["Total",Object(h.jsx)("span",{className:"required-label",children:"*"})]}),Object(h.jsx)("input",{value:kt,readOnly:!0,type:"text",class:"form-control",id:""})]}),Object(h.jsx)("div",{class:"form-group col-3 p-0 purchase-create-mid-plus-img",children:Object(h.jsx)("img",{className:"img-fluid",onClick:function(){return function(){if(o&&v&&F&&T&&I&&R&&G&&X&&ee&&re&&M){var e={item:G,description:ve,unit:X,cost_per_unit:ee,qty:re,free:oe,tax:M,discount_type:je,discountValue:he,total:kt,amount_before_tax_item:qt,tax_amount_item:Tt,amount_after_tax_item:At,amount_before_discount:Dt,discount_amount:It,amount_after_discount:Pt};if(Ct){Ft("");var t=[];Le.map((function(a,c){c==parseInt(Ct)-1?t.push(e):t.push(a)}));var a=0,r=0,s=0;t.map((function(e){a=parseFloat(a)+parseFloat(e.tax_amount_item),r=parseFloat(r)+parseFloat(e.total),s=parseFloat(s)+parseFloat(e.discount_amount)})),vt(a),ht(r),_t(s),Qe(t)}else{var n=[].concat(Object(c.a)(Le),[e]),l=0,i=0,u=0;n.map((function(e){l=parseFloat(l)+parseFloat(e.tax_amount_item),i=parseFloat(i)+parseFloat(e.total),u=parseFloat(u)+parseFloat(e.discount_amount)})),vt(l),_t(u),ht(i),ht(parseFloat(pt)+parseFloat(kt)),Qe(n)}H(""),te(0),Y(""),te(0),se(0),ie(0),E(""),be(""),xe(0),ge(""),kt=0,qt=0,At=0,Tt=0,Dt=0,Pt=0,It=0}else m.b.error("Fill all fields having *")}()},style:{cursor:"pointer"},src:u.a,alt:""})})]})]}),Le.length>0&&Object(h.jsx)("div",{className:"my-table-responsive",children:Object(h.jsxs)("table",{class:"table mt-4",children:[Object(h.jsx)("thead",{class:"thead-dark",children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{scope:"col",children:"Items"}),Object(h.jsx)("th",{scope:"col",children:"Description"}),Object(h.jsx)("th",{scope:"col",children:"Unit"}),Object(h.jsx)("th",{scope:"col",children:"Cost/Unit"}),Object(h.jsx)("th",{scope:"col",children:"Quantity"}),Object(h.jsx)("th",{scope:"col",children:"Free"}),Object(h.jsx)("th",{scope:"col",children:"Tax%"}),Object(h.jsx)("th",{children:"Discount"}),Object(h.jsx)("th",{scope:"col",children:"Total"}),Object(h.jsx)("th",{children:"Actions"})]})}),Object(h.jsx)("tbody",{className:"table-borderless",children:Le.map((function(e,t){return Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:e.item.label}),Object(h.jsx)("td",{children:e.description}),Object(h.jsx)("td",{children:e.unit.label}),Object(h.jsx)("td",{children:e.cost_per_unit}),Object(h.jsx)("td",{children:e.qty}),Object(h.jsx)("td",{children:e.free}),Object(h.jsx)("td",{children:e.tax}),Object(h.jsxs)("td",{children:[e.discountValue," ",e.discount_type]}),Object(h.jsx)("td",{children:e.total}),Object(h.jsxs)("td",{children:[Object(h.jsx)("i",{style:{cursor:"pointer"},onClick:function(){return function(e,t){Ft(t),H(e.item),ge(e.description),Y(e.unit),te(e.cost_per_unit),se(e.qty),ie(e.free),E(e.tax),be(e.discount_type),xe(e.discountValue),kt=e.total}(e,t+1)},class:"fa fa-pencil","aria-hidden":"true"}),Object(h.jsx)("i",{onClick:function(){return function(e){var t=[];Le.map((function(a,c){c!=e&&t.push(a)})),Qe(t)}(t)},style:{cursor:"pointer"},class:"fa fa-trash","aria-hidden":"true"})]})]})}))})]})}),Object(h.jsxs)("div",{children:[Object(h.jsxs)("div",{children:["taxabale amount:- ",ft&&ft]}),Object(h.jsxs)("div",{children:["discount amount:- ",St&&St]})]}),Object(h.jsxs)("div",{className:"row mt-5 justify-content-between purchase-create-footer",children:[Object(h.jsxs)("div",{class:"form-group col-md-5",children:[Object(h.jsx)("label",{for:"exampleFormControlTextarea1",children:"Remarks"}),Object(h.jsx)("textarea",{value:_e,onChange:function(e){return Ne(e.target.value)},class:"form-control",id:"exampleFormControlTextarea1",rows:"5"})]}),Object(h.jsxs)("div",{className:"col-md-6",children:[Object(h.jsxs)("div",{class:"form-group row",children:[Object(h.jsx)("label",{for:"",class:"col-md-4 col-form-label",children:"Total Value"}),Object(h.jsx)("div",{class:"col-md-8",children:Object(h.jsx)("input",{type:"text",value:pt,readOnly:!0,class:"form-control",id:""})})]}),"Bill"==R&&Object(h.jsxs)("div",{class:"form-group row",children:[Object(h.jsx)("label",{for:"",class:"col-md-4 col-form-label",children:"Discount"}),Object(h.jsxs)("div",{class:"pr-0 col-md-8 row",children:[Object(h.jsx)("div",{className:"pr-0 col-5",children:Object(h.jsx)("input",{class:"form-control",value:ct,onChange:function(e){return rt(e.target.value)},type:"text",name:"",id:""})}),Object(h.jsx)("div",{className:"px-0 col-7",children:Object(h.jsxs)("select",{value:$e,onChange:function(e){return et(e.target.value)},class:"form-control",required:!0,children:[Object(h.jsx)("option",{value:"",children:"Select Type"}),Object(h.jsx)("option",{value:"percent",children:"Percent"}),Object(h.jsx)("option",{value:"amount",children:"Amount"})]})})]})]}),"Both"==R&&Object(h.jsxs)("div",{class:"form-group row",children:[Object(h.jsx)("label",{for:"",class:"col-md-4 col-form-label",children:"Discount"}),Object(h.jsxs)("div",{class:"pr-0 col-md-8 row",children:[Object(h.jsx)("div",{className:"pr-0 col-5",children:Object(h.jsx)("input",{class:"form-control",type:"text",value:ct,onChange:function(e){return rt(e.target.value)}})}),Object(h.jsx)("div",{className:"px-0 col-7",children:Object(h.jsxs)("select",{value:$e,onChange:function(e){return et(e.target.value)},class:"form-control",required:!0,children:[Object(h.jsx)("option",{value:"",children:"Select Type"}),Object(h.jsx)("option",{value:"percent",children:"Percent"}),Object(h.jsx)("option",{value:"amount",children:"Amount"})]})})]})]}),Object(h.jsxs)("div",{class:"form-group row",children:[Object(h.jsx)("label",{for:"",class:"col-md-4 col-form-label",children:"Final Amount"}),Object(h.jsx)("div",{class:"col-md-8",children:Object(h.jsx)("input",{readOnly:!0,value:Ge,type:"text",class:"form-control",id:""})})]}),Object(h.jsxs)("div",{class:"form-group row",children:[Object(h.jsx)("label",{for:"",class:"col-md-4 col-form-label",children:"Round Off Total"}),Object(h.jsx)("div",{class:"col-md-8",children:Object(h.jsx)("input",{readOnly:!0,value:He,type:"text",class:"form-control",id:""})})]}),Object(h.jsxs)("div",{class:"form-group row",children:[Object(h.jsx)("label",{for:"",class:"col-md-4 col-form-label",children:"Paid Amount"}),Object(h.jsx)("div",{class:"col-md-8",children:Object(h.jsx)("input",{value:lt,onChange:function(e){return ot(e.target.value)},type:"text",class:"form-control",id:""})})]}),lt>0&&Object(h.jsxs)("div",{class:"form-group row",children:[Object(h.jsx)("label",{for:"",class:"col-md-4 col-form-label",children:"Payment Method"}),Object(h.jsx)("div",{class:"col-md-8",children:Object(h.jsxs)("select",{value:dt,onChange:function(e){return jt(e.target.value)},id:"input-party",class:"form-control",required:!0,children:[Object(h.jsx)("option",{value:"",children:"Select payment mode"}),Object(h.jsx)("option",{value:"cash",children:"Cash"}),Object(h.jsx)("option",{value:"bank",children:"Bank"})]})})]}),Object(h.jsxs)("div",{class:"form-group row",children:[Object(h.jsx)("label",{for:"",class:"col-md-4 col-form-label",children:"Remain Amount"}),Object(h.jsx)("div",{class:"col-md-8",children:Object(h.jsx)("input",{type:"text",value:Ke,readOnly:!0,class:"form-control",id:""})})]})]})]})]}),Object(h.jsxs)("div",{class:"d-flex justify-content-center create-catagory-btns",children:[Object(h.jsxs)("button",{type:"button",onClick:function(){return window.location.reload()},class:"font-weight-bold m-3 py-2 px-4 btn btn-danger",children:["Cancel",Object(h.jsx)("i",{class:"px-2 fa fa-times","aria-hidden":"true"})]}),Object(h.jsxs)("button",{type:"button",onClick:function(){return function(){if(o&&_&&v&&F&&I&&Le.length>0&&pt){var a=function(){var a=Object(n.a)(s.a.mark((function a(){var c,r;return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch(j.d+"create/purchaseReturn",{method:"POST",headers:{Authorization:t.token},body:i});case 2:if(1!=(c=a.sent).ok){a.next=8;break}return a.next=6,c.json();case 6:200==(r=a.sent).status?e.push("/#/create/purchase"):m.b.error(r.message);case 8:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),c={invoiceNo:o,purchaseDate:v,currentParty:F,currentLos:I,returnDate:_},r={totalValue:pt,finalAmount:Ge,roundOffTotal:He,paidAmount:lt,remainAmount:Ke,finalDiscountValue:ct,finalDiscountCriteria:$e,remarks:_e,paymentMethod:dt,taxableAmount:ft},l=[];l.push(c),l.push(r);var i=new FormData;i.append("final_array",JSON.stringify(l)),i.append("allItems",JSON.stringify(Le)),a()}else m.b.error("Please fill the data with *")}()},class:"font-weight-bold m-3 py-2 px-4 btn btn-success",children:["Save",Object(h.jsx)("i",{class:"px-2 fa fa-floppy-o","aria-hidden":"true"})]})]})]})]})}}}]);
//# sourceMappingURL=24.d08c47bd.chunk.js.map