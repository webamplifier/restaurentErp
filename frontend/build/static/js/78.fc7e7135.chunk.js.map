{"version":3,"sources":["screens/Roles/Permission.js"],"names":["Permission","React","useContext","userContext","user","setLoad","useState","parentPermission","setParentPermission","setPermissioBasedRole","SetLoading","id","useParams","useEffect","a","fetch","url","headers","token","response","ok","json","data","parent_permission_list","permissioBasedRole","fetchPermission","map","item","checkebox","$","Parent_name","i","length","chekBox","data_type","attr","View","checked","Add","Edit","Delete","className","class","scope","index","data-type","type","onClick","value","final_list","second_list","permission","j","push","formData","FormData","append","JSON","stringify","method","body","status","window","location","reload","origin","toast","error","message","sendPermission","addPermission"],"mappings":"8UAOe,SAASA,IAAc,IAAD,EACRC,IAAMC,WAAWC,KAAlCC,EADyB,EACzBA,KAAKC,EADoB,EACpBA,QADoB,EAEeJ,IAAMK,SAAS,IAF9B,mBAE1BC,EAF0B,KAERC,EAFQ,OAGaP,IAAMK,SAAS,IAH5B,gCAImBL,IAAMK,SAAS,KAJlC,mBAING,GAJM,aAKHR,IAAMK,UAAS,GALZ,mBAKjBI,GALiB,WAOzBC,EAAOC,cAAPD,GAuDRV,IAAMY,WAAU,WAAM,4CAGlB,8BAAAC,EAAA,sEAC2BC,MAAMC,IAAM,sBAAwBL,EAAI,CAC3DM,QAAS,CACL,cAAiBb,EAAKc,SAHlC,WAOwB,KANdC,EADV,QAOiBC,GAPjB,iCAQ2BD,EAASE,OARpC,OAQcC,EARd,OASQjB,GAAQ,GACRG,EAAoBc,EAAKC,wBACzBd,EAAqB,OAACa,QAAD,IAACA,OAAD,EAACA,EAAME,oBAC5Bd,GAAW,GAZnB,6CAHkB,sBAClBL,GAAQ,GACRK,GAAW,GAFO,mCAmBlBe,KAED,CAACd,IA4CJ,OAvCIJ,EAAiBmB,KAAI,SAAAC,GAGjB,IAFA,IAAMC,EAAYC,IAAE,IAAD,OAAKF,EAAKG,YAAV,aAEVC,EAAI,EAAGA,EAAIH,EAAUI,OAAQD,IAAK,CACvC,IAAME,EAAUL,EAAUG,GACpBG,EAAYL,IAAEI,GAASE,KAAK,aAGjB,QAAbD,GACiB,WAAbP,EAAKS,OACLH,EAAQI,SAAU,GAGT,OAAbH,GACgB,WAAZP,EAAKW,MACLL,EAAQI,SAAU,GAIT,QAAbH,GACiB,WAAbP,EAAKY,OACLN,EAAQI,SAAU,GAKT,UAAbH,GACmB,WAAfP,EAAKa,SACLP,EAAQI,SAAU,OAYlC,0BAASI,UAAU,oBAAnB,UACI,cAAC,IAAD,IACA,wBAAOC,MAAM,QAAb,UACI,gCACI,+BACI,oBAAIC,MAAM,QACV,oBAAIA,MAAM,MAAV,kBACA,oBAAIA,MAAM,MAAV,iBACA,oBAAIA,MAAM,MAAV,kBACA,oBAAIA,MAAM,MAAV,yBAGR,gCACCpC,EAAiBmB,KAAI,SAACC,EAAMiB,GACzB,OACI,+BACA,oBAAID,MAAM,MAAV,SAAiBhB,EAAKG,cACtB,oBAAIW,UAAS,UAAKd,EAAKG,aAAvB,SAAsC,uBAAOe,YAAU,OAAOC,KAAK,eACnE,oBAAIL,UAAS,UAAKd,EAAKG,aAAvB,SAAsC,uBAAOe,YAAU,MAAMC,KAAK,eAClE,oBAAIL,UAAS,UAAKd,EAAKG,aAAvB,SAAsC,uBAAOe,YAAU,OAAOC,KAAK,eACnE,oBAAIL,UAAS,UAAKd,EAAKG,aAAvB,SAAsC,uBAAOe,YAAU,SAASC,KAAK,0BAMjF,wBAAQL,UAAU,kBAAkBM,QAAS,kBAjJ/B,SAACC,GACnB,IAAIC,EAAa,GAEjB5C,GAAQ,GACR,IAAK,IAAI0B,EAAI,EAAGA,EAAIxB,EAAiByB,OAAQD,IAAK,CAC9C,IAAImB,EAAc,GAEdC,EAAatB,IAAE,IAAD,OAAKtB,EAAiBwB,GAAGD,YAAzB,qBAElB,GAAIqB,EAAWnB,OAAS,EAAG,CACvB,IAAK,IAAIoB,EAAI,EAAGA,EAAID,EAAWnB,OAAQoB,IAAK,CACxC,IAAIzB,EAAOwB,EAAWC,GACtBF,EAAYG,KAAKxB,IAAEF,GAAMQ,KAAK,cAGlCc,EAAW1C,EAAiBwB,GAAGpB,IAAMuC,OAErCD,EAAW1C,EAAiBwB,GAAGpB,IAAM,GAjBhB,4CAqB7B,gCAAAG,EAAA,6DACIJ,GAAW,IACL4C,EAAW,IAAIC,UACZC,OAAO,gBAAiBC,KAAKC,UAAUT,IAChDK,EAASE,OAAO,UAAW7C,GAJ/B,SAM2BI,MAAMC,IAAM,oBAAqB,CACpD2C,OAAQ,OACR1C,QAAS,CACL,cAAiBb,EAAKc,OAE1B0C,KAAMN,IAXd,UAcuB,IARbnC,EANV,QAciBC,GAdjB,kCAe2BD,EAASE,OAfpC,WAecC,EAfd,OAgBQjB,GAAQ,GACW,KAAfiB,EAAKuC,OAjBjB,wBAkBYnD,GAAW,GAlBvB,kBAmBmBoD,OAAOC,SAASC,UAnBnC,WAoBkC,KAAf1C,EAAKuC,OApBxB,0CAqBmBC,OAAOC,SAAWD,OAAOC,SAASE,OAAS,UArB9D,QAuBYC,IAAMC,MAAM7C,EAAK8C,SACjB1D,GAAW,GAxBvB,6CArB6B,0DAkD7B2D,GA+FuDC,IAAnD","file":"static/js/78.fc7e7135.chunk.js","sourcesContent":["import React from 'react'\r\nimport { useParams } from 'react-router-dom'\r\nimport { url } from '../../helpers/helpers';\r\nimport { userContext } from '../../context/UserContext'\r\nimport { toast, ToastContainer } from 'react-toastify'\r\nimport $ from 'jquery'\r\n\r\nexport default function Permission() {\r\n    const { user,setLoad } = React.useContext(userContext);\r\n    const [parentPermission, setParentPermission] = React.useState([]);\r\n    const [finalPermission, setFinalPermission] = React.useState([]);\r\n    const [permissioBasedRole, setPermissioBasedRole] = React.useState([])\r\n    const [loading, SetLoading] = React.useState(false);\r\n\r\n    const { id } = useParams();\r\n\r\n    const addPermission = (value) => {\r\n        let final_list = {}\r\n\r\n        setLoad(true)\r\n        for (let i = 0; i < parentPermission.length; i++) {\r\n            let second_list = [];\r\n            let third_list = []\r\n            let permission = $(`.${parentPermission[i].Parent_name} > input:checked`);\r\n\r\n            if (permission.length > 0) {\r\n                for (let j = 0; j < permission.length; j++) {\r\n                    let item = permission[j];\r\n                    second_list.push($(item).attr('data-type'))\r\n                }\r\n\r\n                final_list[parentPermission[i].id] = second_list;\r\n            } else {\r\n                final_list[parentPermission[i].id] = []\r\n            }\r\n        }\r\n\r\n        async function sendPermission() {\r\n            SetLoading(true);\r\n            const formData = new FormData();\r\n            formData.append('permission_id', JSON.stringify(final_list));\r\n            formData.append('role_id', id);\r\n\r\n            const response = await fetch(url + 'createPermission/', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Authorization': user.token\r\n                },\r\n                body: formData\r\n            })\r\n\r\n            if (response.ok == true) {\r\n                const data = await response.json()\r\n                setLoad(false)\r\n                if (data.status == 200) {\r\n                    SetLoading(false);\r\n                    return window.location.reload()\r\n                } else if (data.status == 404) {\r\n                    return window.location = window.location.origin + '/#/404'\r\n                } else {\r\n                    toast.error(data.message);\r\n                    SetLoading(false);\r\n                }\r\n            }\r\n        }\r\n\r\n        sendPermission()\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        setLoad(true)\r\n        SetLoading(true);\r\n        async function fetchPermission() {\r\n            const response = await fetch(url + 'RolePermissionPage/' + id, {\r\n                headers: {\r\n                    'Authorization': user.token\r\n                }\r\n            })\r\n\r\n            if (response.ok === true) {\r\n                const data = await response.json()\r\n                setLoad(false)\r\n                setParentPermission(data.parent_permission_list);\r\n                setPermissioBasedRole(data?.permissioBasedRole)\r\n                SetLoading(false);\r\n            }\r\n        }\r\n\r\n        fetchPermission();\r\n\r\n    }, [id])\r\n\r\n\r\n    const setCheckbox = () => {\r\n\r\n        parentPermission.map(item => {\r\n            const checkebox = $(`.${item.Parent_name} > input`)\r\n\r\n            for (let i = 0; i < checkebox.length; i++) {\r\n                const chekBox = checkebox[i]\r\n                const data_type = $(chekBox).attr('data-type');\r\n\r\n\r\n                if (data_type == 'View') {\r\n                    if (item.View == 'checked') {\r\n                        chekBox.checked = true\r\n                    }\r\n                }\r\n                if (data_type == 'Add') {\r\n                    if (item.Add == 'checked') {\r\n                        chekBox.checked = true\r\n\r\n                    }\r\n                }\r\n                if (data_type == 'Edit') {\r\n                    if (item.Edit == 'checked') {\r\n                        chekBox.checked = true\r\n\r\n                    }\r\n                }\r\n\r\n                if (data_type == 'Delete') {\r\n                    if (item.Delete == 'checked') {\r\n                        chekBox.checked = true\r\n\r\n                    }\r\n                }\r\n\r\n            }\r\n            return\r\n        })\r\n    }\r\n    setCheckbox();\r\n\r\n    return (\r\n        <section className='parent_permission'>\r\n            <ToastContainer />\r\n            <table class=\"table\">\r\n                <thead>\r\n                    <tr>\r\n                        <th scope=\"col\"></th>\r\n                        <th scope=\"col\">View</th>\r\n                        <th scope=\"col\">Add</th>\r\n                        <th scope=\"col\">Edit</th>\r\n                        <th scope=\"col\">Delete</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                {parentPermission.map((item, index) => {\r\n                    return (\r\n                        <tr>\r\n                        <th scope=\"row\">{item.Parent_name}</th>\r\n                        <td className={`${item.Parent_name}`}><input data-type='View' type=\"checkbox\" /></td>\r\n                        <td className={`${item.Parent_name}`}><input data-type='Add' type=\"checkbox\" /></td>\r\n                        <td className={`${item.Parent_name}`}><input data-type='Edit' type=\"checkbox\" /></td>\r\n                        <td className={`${item.Parent_name}`}><input data-type='Delete' type=\"checkbox\" /></td>\r\n                    </tr>\r\n                    )\r\n                })}\r\n                </tbody>\r\n            </table>\r\n            <button className='btn btn-primary' onClick={() => addPermission()}>Submit</button>\r\n        </section>\r\n    )\r\n}\r\n"],"sourceRoot":""}